##### Policies

- Allow
= group
= dynamic-group
= service (blockstorage, objectstorage-<region_name>, FssOc1Prod, oke, streaming)

- to
= inspect
= read
= use
= manage

- in
= tenancy
= compartment <singleCompartmentName> || <compartment:tree:to:target:if:not:adjacent>
=> if tenancy -> Compartment 1 and policy created in tenancy == valid for Component 1
=> else tenancy -> Compartment 1 -> Compartment 2 and policy created in tenancy targeting Compartment 2:
== Compartment 1:Compartment 2

- where
=> request.permission = /*regex*/
=> request.region = /*regex*/
=> any {request.permission=/*regex*/, request.region=/*other*regex*/}
=> target.<resource>.id = <OCID>
=> target.<resource>.name != /*regex*/
=> target.<resource>.namespace = <namespace>


################################################### COMMON POLICIES ###################################################

##### GOVERNANCE

= usage-reports

define tenancy usage-report as ocid1.tenancy.oc1..aaaaaaaaned4fkpkisbwjlr56u7cj63lf3wffbilvqknstgtvzub7vhqkggq
endorse group Administrators to read objects in tenancy usage-report

Allow group <Example_Group> to read usage-reports in tenancy

##### AUDIT

= audit-events

- Allow group Auditors to inspect all-resources in tenancy
- Allow group Auditors to read instances in tenancy
- Allow group Auditors to read audit-events in tenancy

##### VCN (networks)

= virtual-network-family

- Allow group NetworkAdmins to manage virtual-network-family in tenancy
- Allow group NetworkAdmins to manage load-balancers in tenancy

##### COMPUTE (instances)

= instance-family

Allow group InstanceLaunchers to manage instance-family in compartment ABC
Allow group InstanceLaunchers to read app-catalog-listing in tenancy
Allow group InstanceLaunchers to use volume-family in compartment ABC
Allow group InstanceLaunchers to use virtual-network-family in compartment XYZ

Allow group DedicatedVMHostAdmins to manage dedicated-vm-hosts in tenancy
Allow group DedicatedVMHostAdmins to manage instances in tenancy

Allow group InstancePoolAdmins to read instance-family in tenancy
Allow group InstancePoolAdmins to inspect volumes in tenancy
Allow group InstancePoolAdmins to manage compute-management-family in tenancy

Allow group InstancePoolUsers to use instance-pools in tenancy

Allow group AutoscalingAdmins to manage auto-scaling-configurations in tenancy
Allow group AutoscalingAdmins to manage instance-pools in tenancy

Allow group CatalogSubscribers to manage app-catalog-listing in tenancy

##### VOLUME STORAGE (boot & block volume)

= volume-family

Allow group VolumeAdmins to manage volume-family in tenancy
Allow group VolumeAdmins to use instance-family in tenancy
Allow group VolumeAdmins to use volume-backups in tenancy where request.permission='VOLUME_BACKUP_COPY'
Allow group VolumeAdmins to use boot-volume-backups in tenancy where request.permission='BOOT_VOLUME_BACKUP_COPY'

Allow group VolumeBackupAdmins to inspect instances in tenancy
Allow group VolumeBackupAdmins to inspect volume-attachments in tenancy
Allow group VolumeBackupAdmins to use volumes in tenancy
Allow group VolumeBackupAdmins to manage volume-backups in tenancy
Allow group VolumeBackupAdmins to manage backup-policies in tenancy
Allow group VolumeBackupAdmins to manage backup-policy-assignments in tenancy

Allow group BootVolumeBackupAdmins to inspect instances in tenancy
Allow group BootVolumeBackupAdmins to use volumes in tenancy
Allow group BootVolumeBackupAdmins to manage boot-volume-backups in tenancy
Allow group BootVolumeBackupAdmins to manage backup-policies in tenancy
Allow group BootVolumeBackupAdmins to manage backup-policy-assignments in tenancy

Allow group VolumeGroupCreators to inspect volumes in tenancy
Allow group VolumeGroupCreators to manage volume-groups in tenancy

Allow group VolumeGroupCloners to manage volumes in tenancy
Allow group VolumeGroupCloners to manage volume-groups in tenancy

Allow group VolumeGroupBackupAdmins to inspect volume-groups in tenancy
Allow group VolumeGroupBackupAdmins to inspect volume-group-backups in tenancy
Allow group VolumeGroupBackupAdmins to read volume-backups in tenancy
Allow group VolumeGroupBackupAdmins to manage volumes in tenancy
Allow group VolumeGroupBackupAdmins to manage volume-groups in tenancy
Allow group VolumeGroupBackupAdmins to manage volume-backups in tenancy
Allow group VolumeGroupBackupAdmins to manage volume-group-backups in tenancy

##### FILE STORAGE (file systems)

= file-family

Allow group StorageAdmins to manage file-family in tenancy
Allow group StorageAdmins to manage file-family in compartment ABC

Allow group Managers to read mount-targets in tenancy
Allow group Managers to manage file-systems in tenancy

##### OBJECT STORAGE (objects)

= buckets/objects

Allow group ObjectAdmins to manage buckets in tenancy
Allow group ObjectAdmins to manage objects in tenancy

Allow group ObjectWriters to read buckets in compartment ABC
Allow group ObjectWriters to manage objects in compartment ABC where any {request.permission='OBJECT_CREATE',
                                                                          request.permission='OBJECT_INSPECT'}

Allow group ObjectReaders to read buckets in compartment ABC
Allow group ObjectReaders to read objects in compartment ABC

##### DATABASE

= database-family

Allow group DatabaseAdmins to manage database-family in tenancy

Allow group ExaCCAdmins to manage database-family in tenancy

Allow group DatabaseAdmins to manage autonomous-database-family in tenancy

##### VAULTS (secrets)

= vaults/keys/secret-family

Allow group SecurityAdmins to manage vaults in tenancy
Allow group SecurityAdmins to manage keys in tenancy
Allow group SecurityAdmins to manage secret-family in tenancy

Allow group SecurityAdmins to manage secret-family in compartment ABC where target.vault.id='<vault_OCID>'

Allow group SecurityAdmins to manage keys in compartment ABC where target.vault.id='<vault_OCID>'

Allow group SecurityAdmins to use keys in compartment ABC where target.key.id='<key_OCID>'

Allow group ObjectWriters, VolumeWriters, FileWriters, ClusterWriters, StreamWriters to use key-delegate in compartment ABC where target.key.id = '<key_OCID>'

Allow service blockstorage, objectstorage-<region_name>, FssOc1Prod, oke, streaming to use keys in compartment ABC where target.key.id = '<key_OCID>'

Allow group SecretsUsers to use secret-family in tenancy

##### IAM (identity and access management)

= users/groups

Allow group HelpDesk to manage users in tenancy

Allow group GroupAdmins to inspect users in tenancy
Allow group GroupAdmins to inspect groups in tenancy
Allow group GroupAdmins to use users in tenancy where target.group.name != 'Administrators'
Allow group GroupAdmins to use groups in tenancy where target.group.name != 'Administrators'

# No policy is required to let users manage their own credentials.
# All users have the ability to change and reset their own passwords, manage their own API keys and auth tokens.

Allow group A-Admins to manage all-resources in compartment Project-A

Allow group PHX-Admins to manage all-resources in tenancy where request.region='phx'

##### ADMINISTRATION

= announcements

Allow group AnnouncementListers to inspect announcements in tenancy

Allow group AnnouncementReaders to read announcements in tenancy

##### STREAMS (messaging service)

= streams

Allow group StreamAdmins to manage streams in tenancy

Allow group StreamUsers to use stream-push in tenancy
Allow group StreamUsers to use stream-pull in tenancy

Allow group StreamUsers to use stream-pull in tenancy where target.stream.id = '<stream_OCID>'

##### MONITORING

= metrics

Allow group MetricReaders to inspect metrics in compartment ABC

Allow group MetricReaders to read metrics in compartment ABC where target.metrics.namespace='oci_computeagent'

Allow group MetricPublishers to use metrics in tenancy where target.metrics.namespace='mycustomnamespace'

Allow dynamic-group MetricInstances to read metrics in tenancy

Allow group AlarmUsers to read metrics in tenancy
Allow group AlarmUsers to use ons-topics in tenancy
Allow group AlarmUsers to manage alarms in tenancy

##### NOTIFICATION

= ons-topics/ons-subscriptions

Allow group A-Admins to manage ons-topics in tenancy
Allow group A-Admins to manage ons-subscriptions in tenancy

#### EVENTS

= cloudevents-rules

Allow group RuleReaders to read cloudevents-rules in tenancy

Allow group <RuleAdmins> to inspect compartments in tenancy
Allow group <RuleAdmins> to inspect streams in tenancy
Allow group <RuleAdmins> to use stream-push in tenancy
Allow group <RuleAdmins> to use stream-pull in tenancy
Allow group <RuleAdmins> to use virtual-network-family in tenancy
Allow group <RuleAdmins> to use tag-namespaces in tenancy
Allow group <RuleAdmins> to use ons-topic in tenancy
Allow group <RuleAdmins> to manage function-family in tenancy
Allow group <RuleAdmins> to manage cloudevents-rules in tenancy
